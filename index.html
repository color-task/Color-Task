<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="scripts/checkCompletion.js" type="text/javascript"></script>
    <script src="scripts/queryStringUtils.js" type="text/javascript"></script>
    <title>Welcome</title>
</head>
<style>
    body {
        margin: 0;
        height: 100vh;
        width: 100vw;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #consent {
        width: fit-content;
        font-size: 1.6em;
        line-height: 1.35em;
    }
</style>
<body>
    <div id="consent">
        <div>
            How old are you?
            <br/>
            <br/>
            <div>
                <input type="radio" id="younger-18" name="consent">
                <label for="consent-agree">Younger than 18</label><br/>
                <input type="radio" id="eighteen-or-older" name="consent">
                <label for="consent-disagree">18 and older</label>
            </div>
            <button id="continue">Continue</button>
        </div>
    </div>
</body>
<script>
    checkCompletion();
    saveQueryStringParams();

    localStorage.setItem('color-task-eighteen-or-older', null);

    const youngerThan18Button = document.querySelector('#younger-18');
    const eighteenOrOlderButton = document.querySelector('#eighteen-or-older');
    const continueButton = document.querySelector('#continue');

    const setConsentInSession = id => {
        localStorage.setItem('color-task-eighteen-or-older', (id === 'eighteen-or-older' ? 'true' : 'false'));
    };

    const checkContinue = () => {
        const eighteenOrOlder = localStorage.getItem('color-task-eighteen-or-older');

        if (eighteenOrOlder === 'null') {
            window.alert('Please provide consent before continuing');
        } else {
            window.history.replaceState({}, '', 'color-task.html');
            window.location.assign('color-task.html');
        }
    }

    youngerThan18Button.onclick = e => setConsentInSession(e.currentTarget.id);
    eighteenOrOlderButton.onclick = e => setConsentInSession(e.currentTarget.id);
    continueButton.onclick = () => checkContinue();
</script>
</html>
